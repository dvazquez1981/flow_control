<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button [defaultHref]="'/dispositivo/' + dispositivoId"></ion-back-button>
    </ion-buttons>
    <ion-title>Mediciones registradas - Dispositivo {{ dispositivoId }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="page-mediciones" fullscreen>

  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="paginaAnterior()" [disabled]="offset === 0">Anterior</ion-button>
    </ion-buttons>
  
    <ion-buttons slot="end">
      <ion-button (click)="siguientePagina()" [disabled]="totalCargados < limit">Siguiente</ion-button>
      <ion-button color="primary" (click)="exportarCSV()">Exportar CSV</ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ng-container *ngIf="medicionesAgrupadas && medicionesAgrupadas.length > 0; else sinMediciones">

    <ion-list *ngFor="let grupo of medicionesAgrupadas" lines="none">

      <!-- Encabezado de grupo por fecha -->
      <ion-list-header color="light">
        <ion-label>
          <strong>{{ grupo.fecha | fechaLocal }}</strong>
        </ion-label>
      </ion-list-header>

      <!-- Fila horizontal de mediciones -->
      <div class="fila-mediciones">
        <ion-item class="medicion-item" *ngFor="let medicion of grupo.mediciones; trackBy: trackMedicion">
          <ion-label class="ion-text-center">
            <p><strong>Carril: {{ medicion.carril }}</strong></p>
            <p>Clasificaci√≥n: {{ medicion.clasificacionDescripcion }}</p>
            <p>Valor: {{ +medicion.valor | unidad:'Vehiculos' }}</p>
          </ion-label>
        </ion-item>
      </div>

    </ion-list>

  </ng-container>

  <ng-template #sinMediciones>
    <ion-text color="medium">
      <p class="ion-text-center ion-margin-top">No hay mediciones disponibles.</p>
    </ion-text>
  </ng-template>

</ion-content>
