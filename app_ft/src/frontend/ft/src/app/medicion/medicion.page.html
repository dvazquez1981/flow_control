<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button [defaultHref]="'/dispositivo/' + dispositivoId"></ion-back-button>
    </ion-buttons>
    <ion-title>Mediciones registradas - Dispositivo {{ dispositivoId }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="page-mediciones" fullscreen>

 
  <!-- üîπ Filtros compactos en una sola barra -->
<!-- üîπ Filtros compactos en una sola barra -->
<!-- üîπ Filtros compactos en una sola l√≠nea -->
<ion-toolbar class="filtro-toolbar-compact">
  <div class="filtro-inline">
    <div class="fecha-group">
      <ion-input type="date" [(ngModel)]="fechaDesde"></ion-input>
    </div>
    
    <div class="fecha-group">
      <ion-input type="date" [(ngModel)]="fechaHasta"></ion-input>
    </div>
    

    <ion-button color="medium" (click)="limpiarFiltro()">Limpiar</ion-button>
    <ion-button color="success" (click)="exportarCSV()">Exportar</ion-button>
  </div>
</ion-toolbar>



  <!-- üîπ Barra de controles de paginaci√≥n -->
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="paginaAnterior()" [disabled]="offset === 0">Anterior</ion-button>
    </ion-buttons>

    <ion-buttons slot="end">
      <ion-button (click)="siguientePagina()" [disabled]="totalCargados < limit">Siguiente</ion-button>
    </ion-buttons>
  </ion-toolbar>

  
  <!-- üîπ Lista de mediciones agrupadas -->
  <ng-container *ngIf="medicionesAgrupadas && medicionesAgrupadas.length > 0; else sinMediciones">
    <ion-list *ngFor="let grupo of medicionesAgrupadas" lines="none">

      <!-- Encabezado de grupo por fecha -->
      <ion-list-header color="light">
        <ion-label>
          <strong>{{ grupo.fecha | fechaLocal }}</strong>
        </ion-label>
      </ion-list-header>

      <!-- Fila horizontal de mediciones -->
      <div class="fila-mediciones">
        <ion-item class="medicion-item" *ngFor="let medicion of grupo.mediciones; trackBy: trackMedicion">
          <ion-label class="ion-text-center">
            <p><strong>Carril: {{ medicion.carril }}</strong></p>
            <p>Clasificaci√≥n: {{ medicion.clasificacionDescripcion }}</p>
            <p>Valor: {{ +medicion.valor | unidad:'Vehiculos' }}</p>
          </ion-label>
        </ion-item>
      </div>

    </ion-list>
  </ng-container>

  <ng-template #sinMediciones>
    <ion-text color="medium">
      <p class="ion-text-center ion-margin-top">No hay mediciones disponibles.</p>
    </ion-text>
  </ng-template>

</ion-content>
